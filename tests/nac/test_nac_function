============================= test session starts ==============================
platform linux2 -- Python 2.7.18, pytest-4.6.9, py-1.8.1, pluggy-0.13.0
rootdir: /home/sonic/nac
collected 1 item

test_nac_function.py::test_nac_functionality 
-------------------------------- live log call ---------------------------------
DEBUG    paramiko.transport:transport.py:1874 starting thread (client mode): 0x6c311c90L
DEBUG    paramiko.transport:transport.py:1874 Local version/idstring: SSH-2.0-paramiko_2.12.0
DEBUG    paramiko.transport:transport.py:1874 Remote version/idstring: SSH-2.0-OpenSSH_7.4
INFO     paramiko.transport:transport.py:1874 Connected (version 2.0, client OpenSSH_7.4)
DEBUG    paramiko.transport:transport.py:1874 === Key exchange possibilities ===
DEBUG    paramiko.transport:transport.py:1874 kex algos: curve25519-sha256, curve25519-sha256@libssh.org, ecdh-sha2-nistp256, ecdh-sha2-nistp384, ecdh-sha2-nistp521, diffie-hellman-group-exchange-sha256, diffie-hellman-group16-sha512, diffie-hellman-group18-sha512, diffie-hellman-group-exchange-sha1, diffie-hellman-group14-sha256, diffie-hellman-group14-sha1, diffie-hellman-group1-sha1
DEBUG    paramiko.transport:transport.py:1874 server key: ssh-rsa, rsa-sha2-512, rsa-sha2-256, ecdsa-sha2-nistp256, ssh-ed25519
DEBUG    paramiko.transport:transport.py:1874 client encrypt: chacha20-poly1305@openssh.com, aes128-ctr, aes192-ctr, aes256-ctr, aes128-gcm@openssh.com, aes256-gcm@openssh.com, aes128-cbc, aes192-cbc, aes256-cbc, blowfish-cbc, cast128-cbc, 3des-cbc
DEBUG    paramiko.transport:transport.py:1874 server encrypt: chacha20-poly1305@openssh.com, aes128-ctr, aes192-ctr, aes256-ctr, aes128-gcm@openssh.com, aes256-gcm@openssh.com, aes128-cbc, aes192-cbc, aes256-cbc, blowfish-cbc, cast128-cbc, 3des-cbc
DEBUG    paramiko.transport:transport.py:1874 client mac: umac-64-etm@openssh.com, umac-128-etm@openssh.com, hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, hmac-sha1-etm@openssh.com, umac-64@openssh.com, umac-128@openssh.com, hmac-sha2-256, hmac-sha2-512, hmac-sha1
DEBUG    paramiko.transport:transport.py:1874 server mac: umac-64-etm@openssh.com, umac-128-etm@openssh.com, hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, hmac-sha1-etm@openssh.com, umac-64@openssh.com, umac-128@openssh.com, hmac-sha2-256, hmac-sha2-512, hmac-sha1
DEBUG    paramiko.transport:transport.py:1874 client compress: none, zlib@openssh.com
DEBUG    paramiko.transport:transport.py:1874 server compress: none, zlib@openssh.com
DEBUG    paramiko.transport:transport.py:1874 client lang: <none>
DEBUG    paramiko.transport:transport.py:1874 server lang: <none>
DEBUG    paramiko.transport:transport.py:1874 kex follows: False
DEBUG    paramiko.transport:transport.py:1874 === Key exchange agreements ===
DEBUG    paramiko.transport:transport.py:1874 Kex: curve25519-sha256@libssh.org
DEBUG    paramiko.transport:transport.py:1874 HostKey: ssh-ed25519
DEBUG    paramiko.transport:transport.py:1874 Cipher: aes128-ctr
DEBUG    paramiko.transport:transport.py:1874 MAC: hmac-sha2-256
DEBUG    paramiko.transport:transport.py:1874 Compression: none
DEBUG    paramiko.transport:transport.py:1874 === End of kex handshake ===
DEBUG    paramiko.transport:transport.py:1874 kex engine KexCurve25519 specified hash_algo <built-in function openssl_sha256>
DEBUG    paramiko.transport:transport.py:1874 Switch to new keys ...
DEBUG    paramiko.transport:transport.py:1874 Got EXT_INFO: {u'server-sig-algs': 'rsa-sha2-256,rsa-sha2-512'}
DEBUG    paramiko.transport:transport.py:1874 Adding ssh-ed25519 host key for 172.30.25.82: f2db0b80b860b117ad65a0ca63b5bab3
DEBUG    paramiko.transport:transport.py:1874 Trying discovered key fcacd598da7c9c457336c2c603913615 in /root/.ssh/id_rsa
DEBUG    paramiko.transport:transport.py:1874 userauth is OK
DEBUG    paramiko.transport:transport.py:1874 Finalizing pubkey algorithm for key of type 'ssh-rsa'
DEBUG    paramiko.transport:transport.py:1874 Our pubkey algorithm list: ['rsa-sha2-512', 'rsa-sha2-256', 'ssh-rsa']
DEBUG    paramiko.transport:transport.py:1874 Server-side algorithm list: [u'rsa-sha2-256', u'rsa-sha2-512']
DEBUG    paramiko.transport:transport.py:1874 Agreed upon 'rsa-sha2-512' pubkey algorithm
INFO     paramiko.transport:transport.py:1874 Authentication (publickey) failed.
DEBUG    paramiko.transport:transport.py:1874 userauth is OK
INFO     paramiko.transport:transport.py:1874 Authentication (password) successful!
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Max packet in: 32768 bytes
DEBUG    paramiko.transport:transport.py:1874 Received global request "hostkeys-00@openssh.com"
DEBUG    paramiko.transport:transport.py:1874 Rejecting "hostkeys-00@openssh.com" global request from server.
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Max packet out: 32768 bytes
DEBUG    paramiko.transport:transport.py:1874 Secsh channel 0 opened.
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Sesch channel 0 request ok

DEBUG    paramiko.transport:channel.py:1212 [chan 0] EOF received (0)
DEBUG    paramiko.transport:channel.py:1212 [chan 0] EOF sent (0)
DEBUG    paramiko.transport:transport.py:1874 starting thread (client mode): 0x6c2c1810L
DEBUG    paramiko.transport:transport.py:1874 Local version/idstring: SSH-2.0-paramiko_2.12.0
DEBUG    paramiko.transport:transport.py:1874 Remote version/idstring: SSH-2.0-OpenSSH_8.4p1 Debian-5+deb11u1+fips
INFO     paramiko.transport:transport.py:1874 Connected (version 2.0, client OpenSSH_8.4p1)
DEBUG    paramiko.transport:transport.py:1874 === Key exchange possibilities ===
DEBUG    paramiko.transport:transport.py:1874 kex algos: curve25519-sha256, curve25519-sha256@libssh.org, ecdh-sha2-nistp256, ecdh-sha2-nistp384, ecdh-sha2-nistp521, diffie-hellman-group-exchange-sha256, diffie-hellman-group16-sha512, diffie-hellman-group18-sha512, diffie-hellman-group14-sha256
DEBUG    paramiko.transport:transport.py:1874 server key: rsa-sha2-512, rsa-sha2-256, ssh-rsa
DEBUG    paramiko.transport:transport.py:1874 client encrypt: chacha20-poly1305@openssh.com, aes128-ctr, aes192-ctr, aes256-ctr, aes128-gcm@openssh.com, aes256-gcm@openssh.com
DEBUG    paramiko.transport:transport.py:1874 server encrypt: chacha20-poly1305@openssh.com, aes128-ctr, aes192-ctr, aes256-ctr, aes128-gcm@openssh.com, aes256-gcm@openssh.com
DEBUG    paramiko.transport:transport.py:1874 client mac: umac-64-etm@openssh.com, umac-128-etm@openssh.com, hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, hmac-sha1-etm@openssh.com, umac-64@openssh.com, umac-128@openssh.com, hmac-sha2-256, hmac-sha2-512, hmac-sha1
DEBUG    paramiko.transport:transport.py:1874 server mac: umac-64-etm@openssh.com, umac-128-etm@openssh.com, hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, hmac-sha1-etm@openssh.com, umac-64@openssh.com, umac-128@openssh.com, hmac-sha2-256, hmac-sha2-512, hmac-sha1
DEBUG    paramiko.transport:transport.py:1874 client compress: none, zlib@openssh.com
DEBUG    paramiko.transport:transport.py:1874 server compress: none, zlib@openssh.com
DEBUG    paramiko.transport:transport.py:1874 client lang: <none>
DEBUG    paramiko.transport:transport.py:1874 server lang: <none>
DEBUG    paramiko.transport:transport.py:1874 kex follows: False
DEBUG    paramiko.transport:transport.py:1874 === Key exchange agreements ===
DEBUG    paramiko.transport:transport.py:1874 Kex: curve25519-sha256@libssh.org
DEBUG    paramiko.transport:transport.py:1874 HostKey: rsa-sha2-512
DEBUG    paramiko.transport:transport.py:1874 Cipher: aes128-ctr
DEBUG    paramiko.transport:transport.py:1874 MAC: hmac-sha2-256
DEBUG    paramiko.transport:transport.py:1874 Compression: none
DEBUG    paramiko.transport:transport.py:1874 === End of kex handshake ===
DEBUG    paramiko.transport:transport.py:1874 kex engine KexCurve25519 specified hash_algo <built-in function openssl_sha256>
DEBUG    paramiko.transport:transport.py:1874 Switch to new keys ...
DEBUG    paramiko.transport:transport.py:1874 Got EXT_INFO: {u'server-sig-algs': 'ssh-ed25519,sk-ssh-ed25519@openssh.com,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ecdsa-sha2-nistp256@openssh.com,webauthn-sk-ecdsa-sha2-nistp256@openssh.com'}
DEBUG    paramiko.transport:transport.py:1874 Adding ssh-rsa host key for 172.30.25.102: 6115bbe395e1e9f0dfd6d46d73ce2b7e
DEBUG    paramiko.transport:transport.py:1874 Trying discovered key fcacd598da7c9c457336c2c603913615 in /root/.ssh/id_rsa
DEBUG    paramiko.transport:transport.py:1874 userauth is OK
DEBUG    paramiko.transport:transport.py:1874 Finalizing pubkey algorithm for key of type 'ssh-rsa'
DEBUG    paramiko.transport:transport.py:1874 Our pubkey algorithm list: ['rsa-sha2-512', 'rsa-sha2-256', 'ssh-rsa']
DEBUG    paramiko.transport:transport.py:1874 Server-side algorithm list: [u'ssh-ed25519', u'sk-ssh-ed25519@openssh.com', u'ssh-rsa', u'rsa-sha2-256', u'rsa-sha2-512', u'ssh-dss', u'ecdsa-sha2-nistp256', u'ecdsa-sha2-nistp384', u'ecdsa-sha2-nistp521', u'sk-ecdsa-sha2-nistp256@openssh.com', u'webauthn-sk-ecdsa-sha2-nistp256@openssh.com']
DEBUG    paramiko.transport:transport.py:1874 Agreed upon 'rsa-sha2-512' pubkey algorithm
INFO     paramiko.transport:transport.py:1874 Authentication (publickey) failed.
DEBUG    paramiko.transport:transport.py:1874 userauth is OK
INFO     paramiko.transport:transport.py:1874 Authentication (password) successful!
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Max packet in: 32768 bytes
DEBUG    paramiko.transport:transport.py:1874 Received global request "hostkeys-00@openssh.com"
DEBUG    paramiko.transport:transport.py:1874 Rejecting "hostkeys-00@openssh.com" global request from server.
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Max packet out: 32768 bytes
DEBUG    paramiko.transport:transport.py:1874 Secsh channel 0 opened.
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Sesch channel 0 request ok
DEBUG    paramiko.transport:channel.py:1212 [chan 1] Max packet in: 32768 bytes
DEBUG    paramiko.transport:channel.py:1212 [chan 1] Max packet out: 32768 bytes
DEBUG    paramiko.transport:transport.py:1874 Secsh channel 1 opened.
DEBUG    paramiko.transport:channel.py:1212 [chan 1] Sesch channel 1 request ok
DEBUG    paramiko.transport:channel.py:1212 [chan 0] EOF sent (0)
DEBUG    paramiko.transport:transport.py:1874 Ignoring message for dead channel 0
DEBUG    paramiko.transport:transport.py:1874 Ignoring message for dead channel 0
DEBUG    paramiko.transport:channel.py:1212 [chan 1] EOF received (1)

DEBUG    paramiko.transport:channel.py:1212 [chan 1] EOF sent (1)
DEBUG    paramiko.transport:transport.py:1874 starting thread (client mode): 0x6c2d6bd0L
DEBUG    paramiko.transport:transport.py:1874 Local version/idstring: SSH-2.0-paramiko_2.12.0
DEBUG    paramiko.transport:transport.py:1874 Remote version/idstring: SSH-2.0-OpenSSH_7.4
INFO     paramiko.transport:transport.py:1874 Connected (version 2.0, client OpenSSH_7.4)
DEBUG    paramiko.transport:transport.py:1874 === Key exchange possibilities ===
DEBUG    paramiko.transport:transport.py:1874 kex algos: curve25519-sha256, curve25519-sha256@libssh.org, ecdh-sha2-nistp256, ecdh-sha2-nistp384, ecdh-sha2-nistp521, diffie-hellman-group-exchange-sha256, diffie-hellman-group16-sha512, diffie-hellman-group18-sha512, diffie-hellman-group-exchange-sha1, diffie-hellman-group14-sha256, diffie-hellman-group14-sha1, diffie-hellman-group1-sha1
DEBUG    paramiko.transport:transport.py:1874 server key: ssh-rsa, rsa-sha2-512, rsa-sha2-256, ecdsa-sha2-nistp256, ssh-ed25519
DEBUG    paramiko.transport:transport.py:1874 client encrypt: chacha20-poly1305@openssh.com, aes128-ctr, aes192-ctr, aes256-ctr, aes128-gcm@openssh.com, aes256-gcm@openssh.com, aes128-cbc, aes192-cbc, aes256-cbc, blowfish-cbc, cast128-cbc, 3des-cbc
DEBUG    paramiko.transport:transport.py:1874 server encrypt: chacha20-poly1305@openssh.com, aes128-ctr, aes192-ctr, aes256-ctr, aes128-gcm@openssh.com, aes256-gcm@openssh.com, aes128-cbc, aes192-cbc, aes256-cbc, blowfish-cbc, cast128-cbc, 3des-cbc
DEBUG    paramiko.transport:transport.py:1874 client mac: umac-64-etm@openssh.com, umac-128-etm@openssh.com, hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, hmac-sha1-etm@openssh.com, umac-64@openssh.com, umac-128@openssh.com, hmac-sha2-256, hmac-sha2-512, hmac-sha1
DEBUG    paramiko.transport:transport.py:1874 server mac: umac-64-etm@openssh.com, umac-128-etm@openssh.com, hmac-sha2-256-etm@openssh.com, hmac-sha2-512-etm@openssh.com, hmac-sha1-etm@openssh.com, umac-64@openssh.com, umac-128@openssh.com, hmac-sha2-256, hmac-sha2-512, hmac-sha1
DEBUG    paramiko.transport:transport.py:1874 client compress: none, zlib@openssh.com
DEBUG    paramiko.transport:transport.py:1874 server compress: none, zlib@openssh.com
DEBUG    paramiko.transport:transport.py:1874 client lang: <none>
DEBUG    paramiko.transport:transport.py:1874 server lang: <none>
DEBUG    paramiko.transport:transport.py:1874 kex follows: False
DEBUG    paramiko.transport:transport.py:1874 === Key exchange agreements ===
DEBUG    paramiko.transport:transport.py:1874 Kex: curve25519-sha256@libssh.org
DEBUG    paramiko.transport:transport.py:1874 HostKey: ssh-ed25519
DEBUG    paramiko.transport:transport.py:1874 Cipher: aes128-ctr
DEBUG    paramiko.transport:transport.py:1874 MAC: hmac-sha2-256
DEBUG    paramiko.transport:transport.py:1874 Compression: none
DEBUG    paramiko.transport:transport.py:1874 === End of kex handshake ===
DEBUG    paramiko.transport:transport.py:1874 kex engine KexCurve25519 specified hash_algo <built-in function openssl_sha256>
DEBUG    paramiko.transport:transport.py:1874 Switch to new keys ...
DEBUG    paramiko.transport:transport.py:1874 Got EXT_INFO: {u'server-sig-algs': 'rsa-sha2-256,rsa-sha2-512'}
DEBUG    paramiko.transport:transport.py:1874 Trying discovered key fcacd598da7c9c457336c2c603913615 in /root/.ssh/id_rsa
DEBUG    paramiko.transport:transport.py:1874 userauth is OK
DEBUG    paramiko.transport:transport.py:1874 Finalizing pubkey algorithm for key of type 'ssh-rsa'
DEBUG    paramiko.transport:transport.py:1874 Our pubkey algorithm list: ['rsa-sha2-512', 'rsa-sha2-256', 'ssh-rsa']
DEBUG    paramiko.transport:transport.py:1874 Server-side algorithm list: [u'rsa-sha2-256', u'rsa-sha2-512']
DEBUG    paramiko.transport:transport.py:1874 Agreed upon 'rsa-sha2-512' pubkey algorithm
INFO     paramiko.transport:transport.py:1874 Authentication (publickey) failed.
DEBUG    paramiko.transport:transport.py:1874 userauth is OK
INFO     paramiko.transport:transport.py:1874 Authentication (password) successful!
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Max packet in: 32768 bytes
DEBUG    paramiko.transport:transport.py:1874 Received global request "hostkeys-00@openssh.com"
DEBUG    paramiko.transport:transport.py:1874 Rejecting "hostkeys-00@openssh.com" global request from server.
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Max packet out: 32768 bytes
DEBUG    paramiko.transport:transport.py:1874 Secsh channel 0 opened.
DEBUG    paramiko.transport:channel.py:1212 [chan 0] Sesch channel 0 request ok
DEBUG    paramiko.transport:channel.py:1212 [chan 1] Max packet in: 32768 bytes
DEBUG    paramiko.transport:channel.py:1212 [chan 1] Max packet out: 32768 bytes
DEBUG    paramiko.transport:transport.py:1874 Secsh channel 1 opened.
DEBUG    paramiko.transport:channel.py:1212 [chan 1] Sesch channel 1 request ok
DEBUG    paramiko.transport:channel.py:1212 [chan 0] EOF sent (0)
DEBUG    paramiko.transport:transport.py:1874 Ignoring message for dead channel 0
DEBUG    paramiko.transport:transport.py:1874 Ignoring message for dead channel 0
DEBUG    paramiko.transport:transport.py:1874 Ignoring message for dead channel 0
